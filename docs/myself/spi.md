## SPI简介

SPI 全称为 Service Provider Interface，是一种服务发现机制。SPI本质是将接口实现类的全限定名配置在文件中，并由服务加载器读取配置文件，加载实现类，这样运行时可以动态的为接口替换实现类。

它通过在ClassPath路径下的META-INF/services文件夹查找文件，自动加载文件里所定义的类。

这一机制为很多框架扩展提供了可能，比如在Dubbo、JDBC中都使用到了SPI机制。

- **SPI 机制优势就是解耦**。将接口的定义以及具体业务实现分离，而不是和业务端全部耦合在一端。可以实现**运行时根据业务实际场景启用或者替换具体组件**
- SPI 机制的场景就是 **没有统一实现标准的业务场景**。一般就是，服务端有标准的接口，但是没有统一的实现，需要业务方提供其具体实现。比如说
   JDBC 的 java.sql.Driver 接口和不同云厂商提供的数据库实现包

每个事物都是既有优点，同时也伴随着缺点。要从两个方面去看，不能总盯着一方面。这里说一下 SPI 机制的缺点

- **不能按需加载**。虽然 ServiceLoader做了延迟加载，但是只能通过遍历的方式全部获取。如果其中某些实现类很耗时，而且你也不需要加载它，那么就形成了资源浪费
- **获取某个实现类的方式不够灵活**，只能通过迭代器的形式获取。这两点可以参考 Dubbo SPI 实现方式进行业务优化

